@use 'print/mixins' as tp;
@use 'print/variables' as *;

/* generated content */
title { string-set: title content(), mtime attr(data-mtime); }

main h1[id] { string-set: section content(); }

/* pages */
@page {
  font: $font_size $font_family;
  line-height: $line_height;
  margin: 1.75cm 1cm 1.25cm;
  size: 210mm 11in;

  @top-left {
    padding: 0 0 0.5cm;
    vertical-align: bottom;
  }
  @top-center {
    content: string(title) ' â€“ ' string(mtime);
    padding: 0 0 0.5cm;
    vertical-align: bottom;
  }
  @top-right {
    padding: 0 0 0.5cm;
    vertical-align: bottom;
  }
  @bottom-left {
    padding: 0.125cm 0 0;
    vertical-align: top;
  }
  @bottom-right {
    padding: 0.125cm 0 0;
    vertical-align: top;
  }

  @footnotes {
    border-top: 1pt solid $color_dark;
    margin: 5.5pt 0 0;
    padding: 5.5pt 0 0;
  }
}
@page:blank {
  @top-left { content: none; }
  @top-center { content: none; }
  @top-right { content: none; }
  @bottom-left { content: none; }
  @bottom-right { content: none; }
}
@page:left {
  margin: 1.75cm 1.4cm 1.25cm 1cm;

  @top-left { content: string(section); }
  @bottom-left { content: counter(page); }
}
@page:right {
  margin: 1.75cm 1cm 1.25cm 1.4cm;

  @top-right { content: string(section); }
  @bottom-right { content: counter(page); }
}

@page cover, copyright, datasheet, reference-sheet {
  @top-left { content: none; }
  @top-right { content: none; }
  @bottom-left { content: none; }
  @bottom-right { content: none; }
}
@page cover, datasheet, reference-sheet {
  margin: 0.75cm 1cm;

  @top-center { content: none; }
}
@page cover {
  background: center/190mm no-repeat url(../../tournament-pack/images/cover.png);
}
@page copyright {
  margin-bottom: 1cm;
}
@page datasheet, reference-sheet {
  border: 1pt solid $color_dark;
  padding: 6pt;
}
@page datasheet {
  margin: 1cm 0.75cm;
  size: 11in 210mm;
}

@page table-of-contents:left {
  @top-left { content: 'Table of Contents'; }

  @bottom-left { content: counter(page, lower-roman); }
}
@page table-of-contents:right {
  @top-right { content: 'Table of Contents'; }

  @bottom-right { content: counter(page, lower-roman); }
}

/* body */
body {
  font: $font_size $font_family;
  line-height: $line_height;
}

/* sections */
#cover {
  page: cover;

  #title {
    font: 32pt/1.125 Impact, sans-serif;
    margin: (14 * $h) 0 0;
  }

  #mtime {
    font: 24pt/1.5 Impact, sans-serif;
    margin: 0 0 (21 * $h);
  }

  a {
    font-size: 12pt;
    line-height: 2;
  }

  > div { text-align: center; }
}

#copyright {
  @include tp.two_column();

  page: copyright;
}

#nav {
  @include tp.two_column();

  page: table-of-contents;

  > div { display: none; }
}
#nav_menu {
  list-style: none;
  padding-left: 0;

  a {
    display: block;
    content: content(text) leader('.') target-counter(attr(href), page);

    &.h2 { margin-left: 1em; }
    &.h3 { margin-left: 2em; }
  }

  span { display: none; }
}

#reference_sheet {
  display: block;
  page: reference-sheet;

  #epic-armageddon-reference-sheet {
    @include tp.baselined_text(14pt, 2);

    text-align: center;
    text-transform: uppercase;
  }

  dd { margin: 0; }
}

.force {
  page-break-before: right;
  page: datasheet;

  > h2 {
    margin-bottom: 3pt;
    text-align: center;
  }

  aside.faq > div {
    margin-left: 1.5em;
  }

  > .special-rule { margin-bottom: 3pt; }
}

._army_list {
  page-break-before: right;

  > h3._page_break {
    @include tp.baselined_text($font_size_h2);

    text-align: center;
    text-transform: uppercase;

    &, + p { margin-bottom: 3pt; }
  }
}

/* utility */
._column_break { column-break-before: always; }

._page_break { page-break-before: always; }
._page_break_avoid { page-break-before: avoid; }
._page_break_left { page-break-before: left; }
._page_break_right { page-break-before: right; }

/* FAQ page */
body[id='/faq/'] {
  @include tp.two_column();

  .faq {
    > h2 {
      @include tp.baselined_text($font_size);

      column-break-before: auto;
      margin: 0;
      text-transform: none;
    }

    > dl {
      > dt {
        font-weight: normal;
        float: none;

        &::before {
          content: 'Q: ';
          margin-left: -1.25em;
          position: absolute;
        }

        &::after {
          content: none;
        }

        + dd::before {
          content: 'A: ';
          margin-left: -1.25em;
          position: absolute;
        }
      }
    }
  }
}
